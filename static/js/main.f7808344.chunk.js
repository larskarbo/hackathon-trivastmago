(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{169:function(t,e,a){t.exports=a.p+"static/media/hotel.c02a22e0.png"},170:function(t,e,a){t.exports=a(688)},175:function(t,e,a){},177:function(t,e,a){t.exports=a.p+"static/media/1.b09e75e9.png"},225:function(t,e){},227:function(t,e){},259:function(t,e){},260:function(t,e){},319:function(t,e){},321:function(t,e){},332:function(t,e){},334:function(t,e){},339:function(t,e){},341:function(t,e){},345:function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return h});var n=a(168),r=a(15),s=a.n(r),o=a(27),i=a(25),c=a(26),u=a(346),l=a(667),h=function(){function t(e){Object(i.a)(this,t),this.API_KEY=e}return Object(c.a)(t,[{key:"init",value:function(){var t=Object(o.a)(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.fetchManifest();case 3:this.manifest=t.sent,this.api=l.create({baseURL:"".concat(this.manifest.ApiGatewayRootUrl,"/prod"),headers:{"x-api-key":this.API_KEY}}),this.credentials=null,this.AWS=u,t.next=12;break;case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}},t,this,[[0,9]])}));return function(){return t.apply(this,arguments)}}()},{key:"fetchManifest",value:function(){var t=Object(o.a)(s.a.mark(function t(){var e,a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.get("https://1u31fuekv5.execute-api.eu-west-1.amazonaws.com/prod/manifest/?hostname=".concat("startiot.mic.telenorconnexion.com"));case 3:return e=t.sent,a=e.data,t.abrupt("return",a);case 8:throw t.prev=8,t.t0=t.catch(0),t.t0;case 11:case"end":return t.stop()}},t,this,[[0,8]])}));return function(){return t.apply(this,arguments)}}()},{key:"login",value:function(){var t=Object(o.a)(s.a.mark(function t(e){var a,n,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.username,n=e.password,t.prev=1,t.next=4,this.api({method:"post",url:"/auth/login",data:{userName:a,password:n}});case 4:return r=t.sent,this.credentials=r.data.credentials,this.api.defaults.headers.common.Authorization=this.credentials.token,this.api.defaults.headers.common.identityId=this.credentials.identityId,t.abrupt("return",!0);case 11:throw t.prev=11,t.t0=t.catch(1),t.t0;case 14:case"end":return t.stop()}},t,this,[[1,11]])}));return function(e){return t.apply(this,arguments)}}()},{key:"createCognitoIdentity",value:function(){var t=Object(o.a)(s.a.mark(function t(e){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.AWS.config.region=this.manifest.Region,this.AWS.config.credentials=new u.CognitoIdentityCredentials({IdentityPoolId:this.manifest.IdentityPool,Logins:Object(n.a)({},"cognito-idp.".concat(this.manifest.Region,".amazonaws.com/").concat(this.manifest.UserPool),e)}),t.next=5,this.AWS.config.credentials.getPromise();case 5:return t.abrupt("return",this.AWS.config.credentials);case 8:throw t.prev=8,t.t0=t.catch(0),t.t0;case 11:case"end":return t.stop()}},t,this,[[0,8]])}));return function(e){return t.apply(this,arguments)}}()},{key:"logout",value:function(){this.credentials=null,this.api.defaults.headers.common.Authorization=null,this.api.defaults.headers.common.identityId=null}},{key:"invoke",value:function(){var t=Object(o.a)(s.a.mark(function t(e){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.api(e);case 3:return t.abrupt("return",t.sent);case 6:throw t.prev=6,t.t0=t.catch(0),t.t0;case 9:case"end":return t.stop()}},t,this,[[0,6]])}));return function(e){return t.apply(this,arguments)}}()}]),t}()},37:function(t,e,a){t.exports=a.p+"static/media/ripple.102ff033.gif"},686:function(t,e,a){t.exports=a.p+"static/media/2.0250b574.png"},687:function(t,e,a){t.exports=a.p+"static/media/3.2c2e3c81.png"},688:function(t,e,a){"use strict";a.r(e);var n=a(5),r=a.n(n),s=a(166),o=a.n(s),i=a(25),c=a(26),u=a(35),l=a(34),h=a(36),p=(a(175),a(177),n.Component,a(15)),d=a.n(p),m=a(27),f=a(167),g=a.n(f),b=a(79),v=a.n(b),w=a(221).default,y=new(0,a(345).default)("oy0yDJfZdQkQ52LLCugD6IQNiC8l1Xcacm89kg44"),k="a3k7odshaiipe8-ats.iot.eu-west-1.amazonaws.com",x="eu-west-1",E="elsyshack",O="12ElsyShacK!",j=0,A=function(t){function e(){var t,a;Object(i.a)(this,e);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(t=Object(l.a)(e)).call.apply(t,[this].concat(r)))).addData=function(t,e){a.chartman.data.labels.length>30&&(console.log("this.chartman.data.labels.length: ",a.chartman.data.labels.length),a.chartman.data.labels.shift(),a.chartman.data.datasets[0].data.shift()),a.chartman.data.labels.push(v()(e).locale("no-nb").format("LT")),a.chartman.data.datasets.forEach(function(e,a){0==a?e.data.push(t):(0===j?e.data.push(t):e.data.push(e.data[e.data.length-1]),(j+=1)>4&&(j=0))}),a.chartman.update()},a.main=Object(m.a)(d.a.mark(function t(){var e,n,r,s;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y.init();case 3:return t.next=5,y.login({username:E,password:O});case 5:return t.next=7,y.createCognitoIdentity(y.credentials.token);case 7:return e=t.sent,(n=new Date).setHours(n.getHours()-1),t.next=12,y.invoke({method:"post",url:"/observations/find",data:{query:{size:100,query:{bool:{filter:[{range:{timestamp:{gte:n,lte:new Date}}},{term:{thingName:"00001636"}}]}}}}});case 12:r=t.sent,console.log(r.data.hits.hits),r.data.hits.hits.forEach(function(t){var e=t._source.state.dust,n=t._source.state.timestamp;a.addData(e,n)}),(s=new w({region:x,accessKeyId:e.accessKeyId,secretAccessKey:e.secretAccessKey,sessionToken:e.sessionToken,endpointAddress:k,maximumReconnectTimeMs:8e3,protocol:"wss"})).on("error",function(t){console.error("MQTT error:",t)}),s.on("reconnect",function(){console.error("MQTT reconnect, check topic")}),s.on("message",function(t,e){var n=JSON.parse(e.toString("utf-8"));console.log("mesh: ",n),a.addData(n.state.reported.dust,n.state.reported.timestamp)}),s.on("connect",function(){console.log("connect"),s.subscribe("thing-update/elsyshack/00001636")}),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(0),console.error("An error occured:",t.t0);case 25:case"end":return t.stop()}},t,this,[[0,22]])})),a}return Object(h.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=this.c.getContext("2d");this.chartman=new g.a(t,{type:"line",cubicInterpolationMode:"monotone",data:{labels:[],datasets:[{label:"Rom 312",data:[],backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255,99,132,1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:2}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}}),this.main()}},{key:"render",value:function(){var t=this;return r.a.createElement("div",null,r.a.createElement("canvas",{ref:function(e){t.c=e},width:"400",height:"400"}))}}]),e}(n.Component),I=(a(686),a(37)),C=a.n(I),N=(a(687),a(169)),S=a.n(N),D=function(t){function e(){return Object(i.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"wrap"},r.a.createElement("div",{className:"inwrap"},r.a.createElement("div",null,r.a.createElement("h1",{className:"tow"},r.a.createElement("span",{className:"red"},"triv"),r.a.createElement("span",{className:"two"},"astma"),r.a.createElement("span",{className:"third"},"go")," insights\u2122"),r.a.createElement("p",null,"Hei, Petter Stordalen! Her har du en oversikt over ditt hotell"),r.a.createElement("div",{style:{position:"relative"}},r.a.createElement("img",{src:S.a}),r.a.createElement("img",{src:C.a,style:{position:"absolute",width:"100px",left:180,top:170}}),r.a.createElement("img",{src:C.a,style:{position:"absolute",width:"100px",left:380,top:170}}),r.a.createElement("img",{src:C.a,style:{position:"absolute",width:"100px",left:420,top:150}}),r.a.createElement("img",{src:C.a,style:{position:"absolute",width:"100px",left:460,top:130}}),r.a.createElement("img",{src:C.a,style:{position:"absolute",width:"100px",left:600,top:80}})),r.a.createElement(A,null)))))}}]),e}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},77:function(t,e){}},[[170,2,1]]]);
//# sourceMappingURL=main.f7808344.chunk.js.map